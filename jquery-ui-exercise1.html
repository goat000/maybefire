<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retirement Planning Buckets</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <style>
        .slider-container {
            float: left;
            margin-right: 10px;
            width: 100px;
        }

        .slider-vertical {
            width: 100px;
            height: 200px;
            margin-top: 20px;
        }

        .slider-filled {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: url('stack_of_money_recurring.png') repeat-y;
            background-size: 100% auto;
            background-position: bottom;
            background-clip: content-box;
            z-index: 2;
        }

        .slider-vertical .ui-slider-handle {
            width: 100%;
            left: 0;
            margin-left: 0;
        }

        .slider-label {
            height: 40px; /* Adjust the height as needed to fit the largest label */
            text-align: center;
            margin-bottom: 5px; /* Add some space between the label and the slider */
            overflow: hidden; /* Prevents text from overflowing the fixed height */
        }

        .slider-value {
            text-align: center;
            margin-top: 5px;
        }

        input.slider-value-input {
            width: 100%;
            text-align: center;
        }

        .buckets {
            width: 150px;
            float:left;
            margin-left:25px;
            text-align:center;
        }

        .bucket-container {
            width: 100px;
            height: 100px;
            margin:auto;
            border-bottom: 2px solid black;
            border-left: 2px solid black;
            border-right: 2px solid black;
            border-top: transparent;
            position: relative;
        }

        .bucket-fill {
            background-color: blue;
            width: 100%;
            position: absolute;
            bottom: 0;
        }

        input.bucket-value-input {
            width: 100%;
            text-align: center;
            margin-top:5px;
            margin-bottom:20px;
        }

    </style>
</head>
<body>

    <div id="sliders">
        <div class="slider-container">
            <div class="slider-label">Year 1 Withdrawal</div>
            <div id="slider-vertical-0" class="slider-vertical">
                <div id="slider-filled-0" class="slider-filled"></div>
            </div>
            <input type="text" id="slider-value-0" class="slider-value-input"/>
        </div>
        <div class="slider-container">
            <div class="slider-label">Year 2 Withdrawal</div>
            <div id="slider-vertical-1" class="slider-vertical">
                <div id="slider-filled-1" class="slider-filled"></div>
            </div>
            <input type="text" id="slider-value-1" class="slider-value-input"/>
        </div>
        <div class="slider-container">
            <div class="slider-label">Year 3 Withdrawal</div>
            <div id="slider-vertical-2" class="slider-vertical">
                <div id="slider-filled-2" class="slider-filled"></div>
            </div>
            <input type="text" id="slider-value-2" class="slider-value-input"/>
        </div>
        <div class="buckets">
            Withdrawals taxed at 0%
            <div class="bucket-container">
                <div class="bucket-fill" id="zero-percent-bucket" style="height: 0%;"></div>
            </div>
            <input type="text" id="zero-percent-value" class="bucket-value-input" readonly/>
            Withdrawals taxed at 10%
            <div class="bucket-container">
                <div class="bucket-fill" id="ten-percent-bucket" style="height: 0%;"></div>
            </div>
            <input type="text" id="ten-percent-value" class="bucket-value-input" readonly/>
            Withdrawals taxed at 12%
            <div class="bucket-container">
                <div class="bucket-fill"  id="twelve-percent-bucket" style="height: 0%;"></div>
            </div>
            <input type="text" id="twelve-percent-value" class="bucket-value-input" readonly/>
        </div>
    </div>

    <script>
        $(function() {
            [0,1,2].forEach(function(label, index) {
                alert("hi hi");
                var sliderId = 'slider-vertical-' + index;
                var sliderValueId = 'slider-value-' + index;


                $('#' + sliderId).slider({
                    orientation: "vertical",
                    range: "min",
                    min: 0,
                    max: 100,
                    value: 34,
                    step: 1,
                    slide: function(event, ui) {
                        var percentage = ui.value;
                        var heightFilled = (percentage / 100) * $(this).height();
                        $(this).children('.slider-filled').height(heightFilled);
                        $('#' + sliderValueId).val(ui.value);
                    },
                    create: function(event, ui) {
                        var initialValue = $(this).slider("value");
                        var initialHeight = (initialValue / 100) * $(this).height();
                        $(this).children('.slider-filled').height(initialHeight);
                        $('#' + sliderValueId).val(initialValue);
                    }
                });
            });

            // Add change event listener to the first three text boxes
            $("#slider-value-0, #slider-value-1, #slider-value-2").on('change', function() {
                var textboxId = $(this).attr('id');
                var value = parseInt($(this).val(), 10); // Get the integer value from the text box

                // Validate the value is within the min and max range of 0 to 100
                if (isNaN(value) || value < 0 || value > 100) {
                    alert('Please enter a whole number between 0 and 100.');
                    $(this).val(''); // Clear the invalid value
                    return;
                }

                // Update the corresponding slider with the new value
                var sliderId = textboxId.replace('slider-value', 'slider-vertical');
                $("#" + sliderId).slider("value", value);
            });

            function setBucketFillLevel(percentage) {
                const fillElement = document.querySelector('.bucket-fill');
                fillElement.style.height = `${percentage}%`;
            }


        });
    </script>
</body>
</html>

